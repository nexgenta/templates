<?php require(dirname(__FILE__) . '/header.php'); ?>

<div id="primary">

<div class="section">
<?php

	 if(isset($version))
	 {
		 if($version->hasVideo)
		 {
			 echo '<div class="player-wrap video-wrap"><video class="player" controls>' . "\n";
			 $el = 'video';
		 }
		 else if($version->hasAudio)
		 {
			 echo '<div class="player-wrap audio-wrap"><audio class="player" controls>' . "\n";
			 $el = 'audio';
		 }
		 else
		 {
			 $el = null;
		 }
		 if(strlen($el))
		 {
			 foreach($version->resources as $res)
			 {
				 if(!$res->available)
				 {
					 continue;
				 }
				 if(!strncmp($res->dataContainerFormat, $el . '/', strlen($el) + 1))
				 {
					 echo '<source type="' . _e($res->dataContainerFormat) . '" src="' . _e($res->uri) . '">' . "\n";
				 }
			 }
			 echo '</' . $el . '></div>' . "\n";
		 }
	 }
	 else if(isset($object->image))
	 {
		 writeLn('<p class="depiction"><img src="' . _e($object->image) . '"></p>');
	 }
?>

<p><?php echo str_replace("\n", '<br>', _e($object->description)); ?></p>
</div>

<?php require('object-legal.php'); ?>

</div>

<div id="secondary">

<?php

	 if(isset($object['series']))
	 {
		 
	 }
	 else if(isset($object['show']))
	 {
		 writeLn('<div class="section episode-position">');
		 if(isset($object->episodeNumber))
		 {
			 writeLn('<p>Episode ' . _e($object->episodeNumber) . ' of <a href="' . _e($app_root . $object['show']->relativeURI) . '">' . _e($object['show']->title) . '</a></p>');
		 }
		 else
		 {
			 writeLn('<p>An episode of <a href="' . _e($app_root . $object['show']->relativeURI) . '">' . _e($object['show']->title) . '</a></p>');
		 }
		 writeLn('</div>');
	 }

?>

<?php require(dirname(__FILE__) . '/related-content.php'); ?>
</div>

<?php require(dirname(__FILE__) . '/footer.php');